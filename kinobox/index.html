<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico">
    <title>КиноБокс Плеер</title>
</head>
<style>
    .kinobox_player {width: 100%; height: 100%; margin-top: 120px;}
    body {margin: 0; background-color: #130f40; background: linear-gradient(315deg, #130f40 0%, #000000 74%); height: 100vh; display: flex; flex-direction: column; font-family: Arial, Helvetica, sans-serif;}
    .search-container {margin: auto; width: 80vw; margin-top: 10vh; flex-direction: column;}
    
    input {position: relative; background-color: rgba(0, 0, 0, .3); backdrop-filter: blur(400px); -webkit-backdrop-filter: blur(400px); border: 2px solid #fff3; padding: 20px 40px; width: 100%; border-radius: 30px; outline: none; color: #fff; transition: all .2s ease;}
    button {position: absolute; cursor: pointer; right: 12px; aspect-ratio: 1 / 1; opacity: 0; transition: all .3s ease; background-color: #ffffff40; color: #fff; border: none; border-radius: 30px;}
    span {color: rgba(232, 231, 255, 0.404); }
    
    input[type="text"]:focus {border: 2px solid rgb(103, 37, 255);}
    button:hover {background-color: rgb(103, 37, 255);}
    svg {transform: rotatez(90deg); margin-top: 2px;}
    input:focus + button {
            opacity: 1;
    }
    .instruction {
        color: #fff;
            padding: 40px;
            margin-top: 20px;
            border-radius: 20px;
            background-color: rgba(102, 37, 255, 0.747);
            backdrop-filter: blur(400px);
            -webkit-backdrop-filter: blur(400px);
            display: none;
            position: relative;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 32px;
            cursor: pointer;
            color: #ffffff;
        }
        h2 {
            margin-bottom: 30px;
        }
</style>
<body>
    <div class="search-container" id="searchContainer">
        <form onsubmit="event.preventDefault(); searchMovie();" style="display: flex; align-items: center; position: relative;">
            <input type="text" id="title" placeholder="Введите название фильма либо ID" required>
            <button type="submit" onclick="searchMovie()"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" viewBox="0 0 32 32" class="icon-2xl"><path fill="currentColor" fill-rule="evenodd" d="M15.192 8.906a1.143 1.143 0 0 1 1.616 0l5.143 5.143a1.143 1.143 0 0 1-1.616 1.616l-3.192-3.192v9.813a1.143 1.143 0 0 1-2.286 0v-9.813l-3.192 3.192a1.143 1.143 0 1 1-1.616-1.616z" clip-rule="evenodd"></path></svg></button>
        </form>
        <div class="instruction" id="instruction">
            <span class="close-btn" onclick="closeInstruction()">×</span>
            <h2>Как использовать поле ввода?</h2>
            <p>Введите название фильма с Кинопоиска, полный URL либо ID.</p>
            <p>Примеры ввода: «Интерстеллар», «https://www.kinopoisk.ru/film/12345», «12345»</p>
            <span class="close-btn" onclick="closeInstruction()">×</span>
        </div>
    </div>
    
    <div id="player" class="kinobox_player"></div>
    <script src="https://kinobox.tv/kinobox.min.js"></script>
    <script>
        function closeInstruction() {
            document.getElementById('instruction').style.display = 'none';
            localStorage.setItem('instructionShown', 'true');
        }
        document.addEventListener('DOMContentLoaded', function() {
            var instruction = document.getElementById('instruction');
            var instructionShown = localStorage.getItem('instructionShown');

            if (!instructionShown) {
                var input = document.querySelector('input');
                input.addEventListener('focusin', function(event) {
                    if (event.target.closest('input') === input) {
                        instruction.style.display = 'block';
                    }
                });

                input.addEventListener('focusout', function(event) {
                    if (!event.target.closest('input') === input) {
                        instruction.style.display = 'none';
                    }
                });
            }
        });

        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const movieId = urlParams.get('kinopoisk');
            if (movieId) {
                kbox('.kinobox_player', {search: {kinopoisk: movieId}});
            } else {
                document.getElementById('searchContainer').style.display = 'flex';
            }
        }

        function searchMovie() {
            const title = document.getElementById('title').value;

            kbox('.kinobox_player', {search: {query: title}})
            document.getElementById('player').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
